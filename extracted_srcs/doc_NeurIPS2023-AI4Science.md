XLUMINA : An Auto-differentiating Discovery Framework for Super-Resolution Microscopy In this work we introduce XLUMINA , an original computational framework designed for the discovery of novel optical hardware in super-resolution microscopy . Our framework offers auto-differentiation capabilities , allowing for the fast and efficient simulation and automated design of entirely new optical setups from scratch . We showcase its potential by rediscovering three foundational experiments , each one covering different areas in optics : an optical telescope , STED microscopy and the focusing beyond the diffraction limit of a radially polarized light beam . With XLUMINA , can we go beyond simple optimization and calibration of known experimental setups , opening the door to potentially uncovering new microscopy concepts within the vast landscape of experimental possibilities . FINAL SET-UP AI-based exploration tool Objective function e.g . spot size , ϕ = π FWHMxFWHMy 4 Enormously large search space OPTICS SIMULATOR FINAL SET-UP The space of all possible experimental optical configurations is enormous . This is where AI-based exploration techniques could provide enormous benefit , by exploring the space in a fast , unbiased way [ 1 , 2 ] . Among them , the discovery of super-resolution ( SR ) methods , which circumvent the classical diffraction limit of light , stand out in particular . Examples for versatile and powerful SR techniques are STED [ 10 ] , PALM / F-PALM [ 11 , 12 ] , ( d ) STORM [ 13 , 14 ] , SIM [ 15 ] , and MINFLUX [ 16 ] , with considerable impact in biology [ 17 ] [ 18 ] [ 19 ] , chemistry [ 20 ] and material sciences [ 21 ] for example . Rather , this work sets out to discover novel , experimentally viable concepts for advanced optical microscopy that are at-present entirely untapped . The simulator can either be called directly by gradient-based optimization techniques , or it can be used for generating the training data for deep-learning-based surrogate models . We introduce XLUMINA , an efficient framework with auto-differentiation capabilities [ 23 ] for the ultimate goal of discovering new optical design principles . We demonstrate our approach on three foundational optical layouts : a telescope version , the polarization-based beam shaping as used in STED ( stimulated emission depletion ) microscopy [ 10 ] and the sharp focus of a radially polarized light beam [ 24 ] . Rather , the future application of XLUMINA is the AI-driven discovery of completely novel physical concepts for advanced optical microscopy . Optimization in microscopy Our approach is radically different from previous strategies that employ AI for data-driven design of single optical elements [ 25 , 26 ] or data analysis in microscopy , e.g . denoising , contrast enhancement or point-spread-function ( PSF ) engineering [ 27 ] . In contrast , XLUMINA is equipped with tools for simulate , optimize and automatically design new optical setups and concepts from scratch . The main approach is the development of efficient PDE-solvers for Maxwell's equations , including efficient ways to compute the gradients of the vast amount of parameters , usually by a physics-inspired technique called the adjoint method [ 38 , 39 ] . Interestingly , the adjoint method can be seen as a special case of auto-differentiation ( which we use ) [ 39 ] . Several open-source software tools , like Diffractio for light diffraction and interference simulations [ 41 ] , Finesse for simulating gravitational wave detectors [ 42 ] , and POPPY , developed as a part of the simulation package of the James Webb Telescope [ 43 ] , facilitate classical optics phenomena simulations . There are also specialized resources like those focusing on the design of Laguerre-Gaussian mode sorters utilizing multi-plane light conversion ( MPLC ) methods [ 44 ] . While these software offer optics simulation capabilities , XLUMINA uniquely integrates simulation with AI-driven automated design powered with JAX's autodiff and just-in-time ( jit ) compilation capabilities . 2 Software workflow and performance XLUMINA allows for the simulation of classical optics hardware configurations and enables the optimization and automated discovery of new setup designs . The software is developed using JAX [ 45 ] , which provides an advantage of heightened computational speed while seamlessly integrating the auto-differentiation framework [ 23 ] . The first benchmark is to rediscover highly impactful microscopy strategies , such as STED microscopy [ 10 ] or the sharp focus of a radially polarized light beam [ 24 ] , as each of these incorporate different ideas or physical properties of light . To that end , the algorithm is equipped with an optics simulator , which contains a diverse set of optical manipulation , interaction , and measurement technologies . The simulator enables , among many other features , to define light sources ( of any wavelength and power ) , phase masks ( i.e . , spatial light modulators , SLMs ) , polarizers , variable retarders ( e.g . , liquid crystal displays , LCDs ) , diffraction gratings , and high NA lenses to replicate strong focusing conditions . Light propagation and diffraction is simulated by two methods , each available for both scalar and vectorial regimes : the fast-Fourier-transform ( FFT ) based numerical integration of the Rayleigh-Sommerfeld ( RS ) diffraction integral [ 46 , 47 ] and the Chirped z-transform ( CZT ) [ 48 ] . The CZT is an accelerated version of the RS algorithm , which allows for arbitrary selection and sampling of the region of interest . Some functionalities of XLUMINA's optics simulator ( e.g . , optical propagation algorithms , planar lens or amplitude masks ) are inspired in an open-source NumPy-based Python module for diffraction and interferometry simulation , Diffractio [ 41 ] , although we have rewritten and modified these approaches to combine them with JAX's just-in-time ( jit ) functionality . On top of that , we developed completely new functions ( e.g . , LCDs or propagation through high NA objective lens with CZT methods , to name a few ) which significantly expand the software capabilities . The most important hardware addition on the optical simulator are the SLMs , each pixel of which possesses an independent ( and variable ) phase value . They serve as a universal approximation for phase masks ( including lenses ) and offer a computational advantage : given a specific pixel resolution , they allow for unrestricted phase design selection . In addition , we defined under the name of super-SLM ( sSLM ) a hardware-box-type which consists of two SLMs , each one independently imprinting a phase mask on the horizontal and vertical orthogonal polarization components of the field . To include the automated discovery feature , XLUMINA's optical simulator and optimizer are tied together by the loss function . Thus , it is essential to reduce the computation time by maximizing the speed of optical simulation functions . Thus , we evaluate the performance of our optimized functions against their counterparts in Diffractio by propagating a Gaussian beam within a computational window sized at 2048 × 2048 . The average run-time for both Diffractio and our approach is shown in Figure 2a . Generally , our methods significantly enhance computational speeds for simulating light diffraction and propagation . For instance , we observe a speedup of roughly a factor of 2 for RS and VCZT and about 2.5 for VRS using the CPU . CZT has less significant speedup , but there is still a 0.5 - second improvement . When it comes to the nature of the optimizer , it can be either direct ( gradient-based ) or deep learningbased ( surrogate models or deep generative models , e.g . , variational autoencoders [ 49 ] ) . In this work , we adopt a gradient-based strategy , where the experimental setup's parameters are adjusted iteratively in the steepest descent direction . To chose the optimizer , we evaluate the convergence time of two gradient-descent techniques : the Broyden-Fletcher-Goldfarb-Shanno ( BFGS ) algorithm , which numerically computes gradients and higher-order derivative approximations , and the adaptive moment estimation ( ADAM ) , an instance of the stochastic-gradient-descent ( SGD ) method . While BFGS is part of the open-source SciPy Python library and operates on the CPU , ADAM is integrated within the JAX library and runs in both CPU and GPU . For the evaluation , we simulate a Gaussian beam interacting with a phase mask . The objective function is the mean squared error between the detected light and the ground truth , characterized by a Gaussian beam with a spiral phase imprinted on its wavefront . Initializing with an arbitrary phase mask configuration , we run both BFGS and ADAM optimizers over different computational windows and devices , as depicted in Fig . 2b . On the CPU , BFGS exhibits exponential scaling in convergence time , reaching about 6500 seconds for 250 × 250 pixel window . In contrast , ADAM demonstrates superior efficiency , reducing it to roughly 2600 seconds . This makes the GPU-accelerated ADAM approach more appropriate for efficient experimentation . Overall , the computational performance of XLUMINA highlights its suitability for running complex simulations and optimizations with a high level of efficiency . In this section , we showcase the virtual optical designs generated by XLUMINA . This arrangement performs optical Fourier transformations of input light with magnifications determined by the ratio f 2 / f 1 . To revisit this design with a magnification of 2x , we encoded the virtual setup depicted in Fig . 3a , in which traditional lenses are replaced by spatial light modulators ( SLMs ) . The parameter space includes the distances , z 1 , z 2 and z 3 ( measured in millimeters ) and the phase masks ( measured in radians ) of the two SLMs with a resolution of 1024 × 1024 pixels . Each sample consists of a Gaussian beam shaped by amplitude masks in various forms ( circles , rectangles , squares and rings ) , with varying sizes and orientations . The cost function is the mean squared error between the dataset's output and the detected intensity pattern from the virtual setup . The solution depicts lens-like quadratic phases in both SLMs . This suggests that phase mask of SLM #1 might be compensating for this deviation . On the other hand , we believe that the more precise solution for SLM #2 highlights its critical role in imaging . STED microscopy STED microscopy [ 10 ] is based on excitation and spatially targeted depletion of fluorophores . In order to achieve this , a Gaussian-shaped excitation beam and a doughnut-shaped depletion beam are concentrically overlapped . This effectively reduces the area of normal fluorescence , which leads to super-resolution imaging . In order to generate a doughnut-shaped beam a spiral phase is imprinted into the wavefront of a Gaussian beam . To revisit this principle , we virtually construct a simplified version of a STED-type setup as depicted in Fig . 4a . It consists of two light sources generating Gaussian beams corresponding to the depletion and excitation beams with wavelengths of 650 nm and 532 nm , respectively . Within the depletion beam's optical path , we place an SLM of 2048 × 2048 resolution and a computational pixel size of 1.95µm . In this instance , the parameter space is defined by the SLM . For this particular instance , the detected intensity corresponds to the radial component , In Fig . 4b , we present the STED spiral phase mask [ 10 ] and the identified solution for ε = 0.7 . From a random initial phase mask in the SLM , the system converged into a pattern alike to the spiral phase . Other solutions presented noisy phase patterns which failed to achieve the essential doughnut-shaped depletion beam . Real-world STED setups demand almost perfect phase patterns ; even the minor misalignment can compromise the super-resolution STED phenomena . | E x | 2 + | E y | 2 , Sharper focus for a radially polarized light beam The final benchmark focuses on the generation of an ultra-sharp focus for a radially polarized beam , a feature that breaks the diffraction limit in the longitudinal direction as demonstrated by R . The light source emits a 635 nm wavelength Gaussian beam that is linearly polarized . The original optical elements are replaced by an sSLM , each component of which has a resolution of 2048 × 2048 pixels and a computational pixel size of 1.46µm . Additionally , we place an LCD with variable phase retardance η and orientation angle θ . The beam then passes through a high NA objective lens before reaching the detector screen . Relevant data on the sSLM's phase masks , optical parameters , and the simulated spot size are showcased in Fig . 5b and Table 1 . With regards to Solution #2 , the SLM phase pattern also shows a tilted forked grating of topological charge p = 1 . For comparison , we also feature the radial intensity profile of the diffraction-limited linearly polarized beam ( dotted orange line in Fig . 5e ) . This was crucial for our purpose to demonstrate how XLUMINA can compute and efficiently rediscover known techniques in advanced microscopy . We aim to use XLUMINA to discover new microscopy concepts . From here , XLUMINA should be able to extract much more complex solutions which humans might not have thought about yet [ 2 ] . In this work , we present an efficient and reliable simulator for advanced optical microscopy . The simulator is developed in a modular way , and we plan to significantly expand it by adding more physical properties and features exploited in microscopy , for example , detailed coverage of frequency and time information , which might enable systems such as iSCAT [ 56 ] , structured illumination microscopy [ 57 ] , and localization microscopy [ 58 ] . Looking further into the future , one can expect that matter-wave beams ( governed by Schrödinger's equation , which is closely related to the paraxial wave equation , a special case of the electromagnetic field ) can be simulated in the same framework . This might allow for the AI-based design of hybrid microscopy techniques using light and complex electron-beams [ 61 ] or coherent beams of high-mass particles [ 62 ] .